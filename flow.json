[
    {
        "id": "61da1d7d.518484",
        "type": "tab",
        "label": "All Nodes",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d3e7138c.117f6",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "",
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 145,
        "y": 570,
        "wires": [
            [
                "e9be5e32.5c6a1"
            ]
        ]
    },
    {
        "id": "728f06de.9e4098",
        "type": "ui_gauge",
        "z": "61da1d7d.518484",
        "name": "",
        "group": "c3adc197.07776",
        "order": 1,
        "width": "11",
        "height": "11",
        "gtype": "gage",
        "title": "display moist in guage",
        "label": "units",
        "format": "{{value}}",
        "min": "100",
        "max": "1000",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "400",
        "seg2": "600",
        "x": 445,
        "y": 300,
        "wires": []
    },
    {
        "id": "ea56ce96.92c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "check moisture",
        "func": "if(msg.payload.name)\n{\n    flow.set(\"plantConfig\",msg.payload);\n    return msg;\n}\nvar plant=flow.get(\"current\");\nif(msg.payload>=plant.min_water)\n    {\n        flow.set(\"water\",true);\n        msg.payload=1//\"The plant is DRY\";\n    }\nelse\n   {\n       flow.set(\"water\",false);\n        msg.payload=0;//=\"The plant is moist\";\n   }\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 395,
        "y": 375,
        "wires": [
            [
                "3ccfa164.a7baae"
            ]
        ]
    },
    {
        "id": "e6b176fc.eb3448",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "",
        "topic": "plant configration",
        "payload": "{\"name\":\"Kalanhoe\",\"watering\":{\"dry\":{\"min\":600,\"max\":1000}}}",
        "payloadType": "json",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 164,
        "y": 380,
        "wires": [
            [
                "ea56ce96.92c"
            ]
        ]
    },
    {
        "id": "ac43a141.9bfb2",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "",
        "topic": "water",
        "payload": "",
        "payloadType": "date",
        "repeat": "3",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 185,
        "y": 646,
        "wires": [
            [
                "56e8e9d8.b0a1b8"
            ]
        ]
    },
    {
        "id": "56e8e9d8.b0a1b8",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "start watering",
        "func": "var water=flow.get(\"water\");\n\nif(water===true)\n    {\n        msg.payload= 1;\n    }\nelse    \n    {\n        msg.payload= 0;\n        msg.payload=null;\n        return null;\n    }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 422,
        "y": 646,
        "wires": [
            [
                "54a8f62a.7d35f8"
            ]
        ]
    },
    {
        "id": "54a8f62a.7d35f8",
        "type": "trigger",
        "z": "61da1d7d.518484",
        "op1": "1",
        "op2": "0",
        "op1type": "num",
        "op2type": "num",
        "duration": "2",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 630,
        "y": 646,
        "wires": [
            [
                "ddcce64.8810218",
                "d32b8129.138e6"
            ]
        ]
    },
    {
        "id": "8a4c5b10.8e3f48",
        "type": "ui_form",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Add Plant Configuration",
        "group": "ce607c77.3a086",
        "order": 1,
        "width": "0",
        "height": "0",
        "options": [
            {
                "label": "Name",
                "value": "plant_name",
                "type": "text",
                "required": true
            },
            {
                "label": "Min water",
                "value": "min_water",
                "type": "text",
                "required": true
            },
            {
                "label": "Turn on lamp at",
                "value": "lamp_on",
                "type": "text",
                "required": true
            },
            {
                "label": "Turn off lamp at",
                "value": "lamp_off",
                "type": "text",
                "required": true
            }
        ],
        "formValue": {
            "plant_name": "",
            "min_water": "",
            "lamp_on": "",
            "lamp_off": ""
        },
        "payload": "",
        "submit": "submit",
        "cancel": "cancel",
        "topic": "",
        "x": 233,
        "y": 1292,
        "wires": [
            [
                "7ea642bd.744e9c"
            ]
        ]
    },
    {
        "id": "2809b9ee.b2ed46",
        "type": "ui_button",
        "z": "61da1d7d.518484",
        "name": "",
        "group": "ec9c9342.c86e2",
        "order": 6,
        "width": "0",
        "height": "0",
        "passthru": false,
        "label": "Water now",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-tint",
        "payload": "0",
        "payloadType": "num",
        "topic": "",
        "x": 146,
        "y": 779,
        "wires": [
            [
                "50ed9d69.ce10c4",
                "e9be5e32.5c6a1"
            ]
        ]
    },
    {
        "id": "5d2ecfff.79c98",
        "type": "ui_dropdown",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Choose plant program",
        "tooltip": "",
        "place": "Select option",
        "group": "35557d8f.194112",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [],
        "payload": "",
        "topic": "",
        "x": 252,
        "y": 1672,
        "wires": [
            [
                "ec8bfa18.793b88",
                "b4dfc630.27d8f8"
            ]
        ]
    },
    {
        "id": "ea93773f.7de3d8",
        "type": "ui_text",
        "z": "61da1d7d.518484",
        "group": "ec9c9342.c86e2",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Plant name:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1248,
        "y": 1767,
        "wires": []
    },
    {
        "id": "2a65c33c.85da6c",
        "type": "ui_text",
        "z": "61da1d7d.518484",
        "group": "ec9c9342.c86e2",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Min water",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1239,
        "y": 1826,
        "wires": []
    },
    {
        "id": "b7deeaee.989e48",
        "type": "ui_text",
        "z": "61da1d7d.518484",
        "group": "ec9c9342.c86e2",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Turn on lamp at",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1273,
        "y": 1887,
        "wires": []
    },
    {
        "id": "579ead94.f3f6b4",
        "type": "ui_text",
        "z": "61da1d7d.518484",
        "group": "ec9c9342.c86e2",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Turn off lamp at",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "x": 1273,
        "y": 1944,
        "wires": []
    },
    {
        "id": "7741852e.8c233c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "push new plant to all",
        "func": "msg.payload.push(flow.get(\"new_plant\"));\nflow.set(\"saved_programs\",msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 955,
        "y": 1292,
        "wires": [
            [
                "52f383a5.72a65c",
                "a073f53c.9df468",
                "464eb43d.b7f45c"
            ]
        ]
    },
    {
        "id": "7ea642bd.744e9c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "Set to flow new plant",
        "func": "flow.set(\"new_plant\",msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 480,
        "y": 1292,
        "wires": [
            [
                "fbcdfbe9.edeb28"
            ]
        ]
    },
    {
        "id": "40ca9c93.19f534",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "on start",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 212,
        "y": 1045,
        "wires": [
            [
                "e2551288.c1dd",
                "62c20807.735888"
            ]
        ]
    },
    {
        "id": "a073f53c.9df468",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "Read plants config names",
        "func": "var configs=[];\nvar saved=[];\nsaved=flow.get(\"saved_programs\");\nsaved.forEach(function(plant){\n    configs.push(plant.plant_name);\n});\nmsg.options=configs;\nmsg.payload=flow.get(\"current_program\")\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 245,
        "y": 1590,
        "wires": [
            [
                "5d2ecfff.79c98",
                "e67f02b1.d30cc"
            ]
        ]
    },
    {
        "id": "ec8bfa18.793b88",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "set flow current program",
        "func": "flow.set(\"current_program\",msg.payload)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 545,
        "y": 1680,
        "wires": [
            [
                "83fc2735.458918",
                "5dcaa351.a36c5c",
                "1a79489.a6553b7"
            ]
        ]
    },
    {
        "id": "ca5e190d.8202b8",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get current program properties",
        "func": "var program=flow.get(\"current_program\");\nvar dbPlants=msg.payload;\nvar result= dbPlants.filter(progr=>progr.plant_name===program);\nmsg.payload=result[0];\nflow.set(\"current\",msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 757,
        "y": 1843,
        "wires": [
            [
                "ee3ab391.f04d",
                "2685f806.9bfb28",
                "4aa86304.e3f11c",
                "47f42c58.6b0e74"
            ]
        ]
    },
    {
        "id": "ee3ab391.f04d",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get name",
        "func": "msg.payload=msg.payload.plant_name;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1029,
        "y": 1767,
        "wires": [
            [
                "ea93773f.7de3d8"
            ]
        ]
    },
    {
        "id": "2685f806.9bfb28",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get min water",
        "func": "msg.payload=msg.payload.min_water;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1049,
        "y": 1824,
        "wires": [
            [
                "2a65c33c.85da6c"
            ]
        ]
    },
    {
        "id": "4aa86304.e3f11c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get lamp on",
        "func": "msg.payload=msg.payload.lamp_on;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1039,
        "y": 1881,
        "wires": [
            [
                "b7deeaee.989e48",
                "30311ca.ce3fce4"
            ]
        ]
    },
    {
        "id": "47f42c58.6b0e74",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get lamp ff",
        "func": "msg.payload=msg.payload.lamp_off;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1039,
        "y": 1938,
        "wires": [
            [
                "579ead94.f3f6b4",
                "6280febd.db37e"
            ]
        ]
    },
    {
        "id": "323679fa.0cf466",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "set flow current program",
        "func": "flow.set(\"current_program\",msg.payload);\n//msg.payload={msg.payload};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 725,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "6fac51df.e3862",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "set flow saved programs",
        "func": "flow.set(\"saved_programs\",msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 718,
        "y": 1026,
        "wires": [
            []
        ]
    },
    {
        "id": "30311ca.ce3fce4",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "set sheduler on time",
        "func": " msg.payload=\"ontime \"+msg.payload;\nflow.set(\"lamp_on\",msg.payload);\nreturn msg ;",
        "outputs": 1,
        "noerr": 0,
        "x": 910,
        "y": 2475,
        "wires": [
            [
                "1cd557ec.4625c8"
            ]
        ]
    },
    {
        "id": "6280febd.db37e",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "set sheduler off time",
        "func": "msg.payload=\"offtime \"+msg.payload;\nflow.set(\"lamp_off\",msg.payload);\nreturn msg ;",
        "outputs": 1,
        "noerr": 0,
        "x": 908,
        "y": 2612,
        "wires": [
            [
                "1cd557ec.4625c8"
            ]
        ]
    },
    {
        "id": "52f383a5.72a65c",
        "type": "DataIn",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "save all plants",
        "update": false,
        "path": "/plants",
        "x": 1220,
        "y": 1292,
        "wires": []
    },
    {
        "id": "5dcaa351.a36c5c",
        "type": "DataIn",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "Save current",
        "update": true,
        "path": "/currentProgram",
        "x": 910,
        "y": 1635,
        "wires": []
    },
    {
        "id": "fbcdfbe9.edeb28",
        "type": "DataOut",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "ReadPlants",
        "path": "/plants",
        "error": false,
        "x": 735,
        "y": 1292,
        "wires": [
            [
                "7741852e.8c233c"
            ]
        ]
    },
    {
        "id": "e2551288.c1dd",
        "type": "DataOut",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "Read plants config",
        "path": "/plants",
        "error": false,
        "x": 432,
        "y": 1026,
        "wires": [
            [
                "6fac51df.e3862"
            ]
        ]
    },
    {
        "id": "83fc2735.458918",
        "type": "DataOut",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "Read plants config",
        "path": "/plants",
        "error": false,
        "x": 765,
        "y": 1755,
        "wires": [
            [
                "ca5e190d.8202b8"
            ]
        ]
    },
    {
        "id": "62c20807.735888",
        "type": "DataOut",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "Read current program",
        "path": "/currentProgram",
        "error": false,
        "x": 442,
        "y": 1083,
        "wires": [
            [
                "323679fa.0cf466"
            ]
        ]
    },
    {
        "id": "8909107b.b4b65",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "on start and every 24 hours",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "86400",
        "crontab": "",
        "once": true,
        "onceDelay": "7",
        "x": 225,
        "y": 105,
        "wires": [
            [
                "12f5fb5c.0b5cc5"
            ]
        ]
    },
    {
        "id": "2538b3ca.d91cfc",
        "type": "ui_template",
        "z": "61da1d7d.518484",
        "group": "af408a37.e5f5c8",
        "name": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<div ng-bind-html=\"msg.payload\"></div>\n<img src=\"{{msg.payload}}\" \nstyle=\"width:640;height:550px; \ntransform: rotate(180deg)\">",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 1067,
        "y": 152,
        "wires": [
            []
        ]
    },
    {
        "id": "9a423e6d.4d555",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get /filename",
        "func": "var dir=msg.payload;\nif(!dir)\n    {\n        return null;\n    }\nif(dir.startsWith(\"/home\"))\n{\n    //var arr=dir.split('/');\n    //msg.payload=\"/\"+arr[arr.length-1];\n    //return msg;\n    msg.payload=\"/\"+msg.filename;\n    return msg;\n}\nelse \nreturn null;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 849,
        "y": 152,
        "wires": [
            [
                "2538b3ca.d91cfc"
            ]
        ]
    },
    {
        "id": "12f5fb5c.0b5cc5",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "create file name",
        "func": "var d = new Date();\nmsg.filename=\nd.getDate()+\"-\"+d.getMonth()+\"-\"+d.getFullYear()+\n\"_\"+d.getHours()+'-'+d.getMinutes()+\".jpg\";\n\nmsg.payload=\"\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 460,
        "y": 152,
        "wires": [
            [
                "a4dba84c.96d7c8"
            ]
        ]
    },
    {
        "id": "ccf2c688.bd9cf8",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "make picture     ",
        "info": "",
        "x": 108,
        "y": 57,
        "wires": []
    },
    {
        "id": "e5d49c77.c1c88",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "read moisture",
        "info": "",
        "x": 145,
        "y": 255,
        "wires": []
    },
    {
        "id": "d15441f1.12cb",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "display moisture",
        "info": "",
        "x": 764,
        "y": 247,
        "wires": []
    },
    {
        "id": "2407b221.eae3ee",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "water pump",
        "info": "",
        "x": 145,
        "y": 525,
        "wires": []
    },
    {
        "id": "71d0d909.94d018",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "on start read configuration and current program",
        "info": "",
        "x": 256,
        "y": 969,
        "wires": []
    },
    {
        "id": "41248a4.8600a74",
        "type": "ui_button",
        "z": "61da1d7d.518484",
        "name": "",
        "group": "af408a37.e5f5c8",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Take picture",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-camera-retro",
        "payload": "",
        "payloadType": "date",
        "topic": "",
        "x": 184,
        "y": 152,
        "wires": [
            [
                "12f5fb5c.0b5cc5"
            ]
        ]
    },
    {
        "id": "831ba9ee.2ee998",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "create new plant configuration",
        "info": "",
        "x": 196,
        "y": 1235,
        "wires": []
    },
    {
        "id": "c4a8e687.7ddfe8",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "on start add names to dropdown and set value",
        "info": "",
        "x": 246,
        "y": 1482,
        "wires": []
    },
    {
        "id": "a4dba84c.96d7c8",
        "type": "usbcamera",
        "z": "61da1d7d.518484",
        "filemode": "1",
        "filename": "",
        "filedefpath": "1",
        "filepath": "/home/pi/Pictures/",
        "fileformat": "png",
        "resolution": "2",
        "name": "",
        "x": 659,
        "y": 152,
        "wires": [
            [
                "9a423e6d.4d555"
            ]
        ]
    },
    {
        "id": "e3835602.892f18",
        "type": "arduino in",
        "z": "61da1d7d.518484",
        "name": "red moisture",
        "pin": "0",
        "state": "ANALOG",
        "arduino": "118e97fc.26aff8",
        "x": 146,
        "y": 304,
        "wires": [
            [
                "728f06de.9e4098",
                "ea56ce96.92c",
                "d279d4d2.8742b8"
            ]
        ]
    },
    {
        "id": "d32b8129.138e6",
        "type": "arduino out",
        "z": "61da1d7d.518484",
        "name": "",
        "pin": "9",
        "state": "OUTPUT",
        "arduino": "118e97fc.26aff8",
        "x": 810,
        "y": 722,
        "wires": []
    },
    {
        "id": "ddcce64.8810218",
        "type": "arduino out",
        "z": "61da1d7d.518484",
        "name": "",
        "pin": "10",
        "state": "OUTPUT",
        "arduino": "118e97fc.26aff8",
        "x": 820,
        "y": 589,
        "wires": []
    },
    {
        "id": "e9be5e32.5c6a1",
        "type": "arduino out",
        "z": "61da1d7d.518484",
        "name": "",
        "pin": "8",
        "state": "OUTPUT",
        "arduino": "118e97fc.26aff8",
        "x": 392,
        "y": 570,
        "wires": []
    },
    {
        "id": "50ed9d69.ce10c4",
        "type": "trigger",
        "z": "61da1d7d.518484",
        "op1": "1",
        "op2": "0",
        "op1type": "num",
        "op2type": "num",
        "duration": "2",
        "extend": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "name": "",
        "x": 383,
        "y": 779,
        "wires": [
            [
                "ddcce64.8810218",
                "d32b8129.138e6"
            ]
        ]
    },
    {
        "id": "cf183eec.c829d",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "check if it works",
        "info": "The payload from the button is 0 for pin 8.\nUse trigger for pins 9 and 10.",
        "x": 156,
        "y": 741,
        "wires": []
    },
    {
        "id": "dca6a686.c9eee8",
        "type": "comment",
        "z": "61da1d7d.518484",
        "name": "add the new plant to current dropdown",
        "info": "",
        "x": 834,
        "y": 1406,
        "wires": []
    },
    {
        "id": "10f94e07.7ec5b2",
        "type": "ui_text_input",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Name",
        "tooltip": "",
        "group": "1eeedcbb.46d953",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 962,
        "y": 2147,
        "wires": [
            [
                "4bb2f365.f0b31c",
                "ea93773f.7de3d8"
            ]
        ]
    },
    {
        "id": "a4bad8d2.25f218",
        "type": "ui_numeric",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Min water",
        "tooltip": "",
        "group": "1eeedcbb.46d953",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1000",
        "step": "50",
        "x": 972,
        "y": 2204,
        "wires": [
            [
                "88c9e0b8.c8386",
                "2a65c33c.85da6c"
            ]
        ]
    },
    {
        "id": "584229d8.ab87d8",
        "type": "ui_text_input",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Lamp on",
        "tooltip": "",
        "group": "1eeedcbb.46d953",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 972,
        "y": 2261,
        "wires": [
            [
                "bf9ab269.7289c",
                "b7deeaee.989e48"
            ]
        ]
    },
    {
        "id": "1db661c3.8026de",
        "type": "ui_text_input",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Lamp off",
        "tooltip": "",
        "group": "1eeedcbb.46d953",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 972,
        "y": 2318,
        "wires": [
            [
                "d0c859cf.6558d8",
                "579ead94.f3f6b4"
            ]
        ]
    },
    {
        "id": "1a79489.a6553b7",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get current program properties",
        "func": "//var program=flow.get(\"current_program\");\n//var dbPlants=msg.payload;\n//var result= dbPlants.filter((progr)=>{return progr.plant_name===program});\n//msg.payload=result[0];\n//flow.set(\"current\",msg.payload)\nmsg.payload=flow.get(\"current\")\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 491,
        "y": 2223,
        "wires": [
            [
                "c73149b6.7a3498",
                "bcb24af4.8d3718",
                "379a9a98.fbadc6",
                "20c56b58.bb37d4"
            ]
        ]
    },
    {
        "id": "c73149b6.7a3498",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get name",
        "func": "msg.payload=msg.payload.plant_name;\nflow.set(\"plant_name\",msg.payload.plant_name);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 763,
        "y": 2147,
        "wires": [
            [
                "10f94e07.7ec5b2"
            ]
        ]
    },
    {
        "id": "bcb24af4.8d3718",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get min water",
        "func": "msg.payload=msg.payload.min_water;\nflow.set(\"min_water\",msg.payload.min_water);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 783,
        "y": 2204,
        "wires": [
            [
                "a4bad8d2.25f218"
            ]
        ]
    },
    {
        "id": "379a9a98.fbadc6",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get lamp on",
        "func": "msg.payload=msg.payload.lamp_on;\nflow.set(\"lamp_on\",msg.payload.lamp_on);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 773,
        "y": 2261,
        "wires": [
            [
                "584229d8.ab87d8",
                "30311ca.ce3fce4"
            ]
        ]
    },
    {
        "id": "20c56b58.bb37d4",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "get lamp ff",
        "func": "msg.payload=msg.payload.lamp_off;\nflow.set(\"lamp_off\",msg.payload.lamp_off);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 2355,
        "wires": [
            [
                "1db661c3.8026de",
                "6280febd.db37e"
            ]
        ]
    },
    {
        "id": "4bb2f365.f0b31c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "var newCurrentName=msg.payload;\nflow.set(\"newPlantName\",newCurrentName);\nvar a = flow.get(\"current\")\na.plant_name=newCurrentName;\nflow.set(\"current\",a);\n//save to db\n//update plants configs\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1171,
        "y": 2147,
        "wires": [
            [
                "6a683df5.854c34"
            ]
        ]
    },
    {
        "id": "6a683df5.854c34",
        "type": "DataOut",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "Read plants config",
        "path": "/plants",
        "error": false,
        "x": 1496,
        "y": 2242,
        "wires": [
            [
                "f64b328f.25caf",
                "3ca054d.e5abaac"
            ]
        ]
    },
    {
        "id": "f64b328f.25caf",
        "type": "DataIn",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "",
        "update": false,
        "path": "/plants",
        "x": 1835,
        "y": 2265,
        "wires": []
    },
    {
        "id": "7295e3dd.faaf2c",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.4",
        "x": 235,
        "y": 2280,
        "wires": [
            [
                "1a79489.a6553b7"
            ]
        ]
    },
    {
        "id": "d72b0ea8.140ff",
        "type": "DataIn",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "",
        "update": false,
        "path": "/currentProgram",
        "x": 1998,
        "y": 2360,
        "wires": []
    },
    {
        "id": "3ca054d.e5abaac",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "flow.set(\"saved_programs\",msg.payload);\nif(flow.get(\"newPlantName\")){\nmsg.payload=flow.get(\"newPlantName\");\n\nflow.set(\"current_program\",flow.get(\"newPlantName\"));    \n\nreturn msg;\n    \n}else{\n    return null;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1325,
        "y": 2085,
        "wires": [
            [
                "d72b0ea8.140ff",
                "85949307.b4271"
            ]
        ]
    },
    {
        "id": "88c9e0b8.c8386",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "\nflow.set(\"min_water\",msg.payload);\nvar a = flow.get(\"current\")\na.min_water=msg.payload;\nflow.set(\"current\",a);\n//save to db\n//update plants configs\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1171,
        "y": 2204,
        "wires": [
            [
                "6a683df5.854c34"
            ]
        ]
    },
    {
        "id": "bf9ab269.7289c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "\nflow.set(\"lamp_on\",msg.payload);\nvar a = flow.get(\"current\")\na.lamp_on=msg.payload;\nflow.set(\"current\",a);\n//save to db\n//update plants configs\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1173,
        "y": 2268,
        "wires": [
            [
                "6a683df5.854c34",
                "30311ca.ce3fce4"
            ]
        ]
    },
    {
        "id": "d0c859cf.6558d8",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "\nflow.set(\"lamp_off\",msg.payload);\nvar a = flow.get(\"current\")\na.lamp_off=msg.payload;\nflow.set(\"current\",a);\n//save to db\n//update plants configs\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1171,
        "y": 2318,
        "wires": [
            [
                "6a683df5.854c34",
                "6280febd.db37e"
            ]
        ]
    },
    {
        "id": "4743f511.f230ac",
        "type": "ui_text_input",
        "z": "61da1d7d.518484",
        "name": "",
        "label": "Remove program",
        "tooltip": "",
        "group": "f6eb4df1.0d706",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 180,
        "y": 2790,
        "wires": [
            [
                "c5850abf.667f28"
            ]
        ]
    },
    {
        "id": "c5850abf.667f28",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "flow.set(\"remove\",msg.payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 395,
        "y": 2790,
        "wires": [
            [
                "374795e0.92e60a"
            ]
        ]
    },
    {
        "id": "374795e0.92e60a",
        "type": "DataOut",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "",
        "path": "/plants",
        "error": false,
        "x": 575,
        "y": 2790,
        "wires": [
            [
                "3169f5ff.3dc91a"
            ]
        ]
    },
    {
        "id": "3169f5ff.3dc91a",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "var result=msg.payload;\nvar remove=flow.get(\"remove\");\nresult=result.filter(function(progr){\n    return progr.plant_name!==remove;\n});\nflow.set(\"saved_programs\",result);\nmsg.payload=result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 2790,
        "wires": [
            [
                "d77615aa.e89d88",
                "a073f53c.9df468"
            ]
        ]
    },
    {
        "id": "d77615aa.e89d88",
        "type": "DataIn",
        "z": "61da1d7d.518484",
        "collection": "4faf0170.b836a",
        "name": "",
        "update": false,
        "path": "/plants",
        "x": 965,
        "y": 2790,
        "wires": []
    },
    {
        "id": "4fd9f491.7b301c",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "on start",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.2",
        "x": 210,
        "y": 1140,
        "wires": [
            [
                "cdb39fc1.e13d1"
            ]
        ]
    },
    {
        "id": "cdb39fc1.e13d1",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "var current=flow.get(\"current_program\");\nvar plants=flow.get(\"saved_programs\");\n\nvar result=plants.filter((el)=>{\n    return el.plant_name===current;\n});\nflow.set(\"current\",result[0]);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 420,
        "y": 1155,
        "wires": [
            [
                "a073f53c.9df468"
            ]
        ]
    },
    {
        "id": "b4dfc630.27d8f8",
        "type": "debug",
        "z": "61da1d7d.518484",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 525,
        "y": 1605,
        "wires": []
    },
    {
        "id": "e67f02b1.d30cc",
        "type": "debug",
        "z": "61da1d7d.518484",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 815,
        "y": 1530,
        "wires": []
    },
    {
        "id": "464eb43d.b7f45c",
        "type": "debug",
        "z": "61da1d7d.518484",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1210,
        "y": 1395,
        "wires": []
    },
    {
        "id": "85949307.b4271",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "msg.payload=flow.get(\"saved_programs\");\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 420,
        "y": 1740,
        "wires": [
            [
                "a073f53c.9df468",
                "602f12d6.d79e2c"
            ]
        ]
    },
    {
        "id": "602f12d6.d79e2c",
        "type": "debug",
        "z": "61da1d7d.518484",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 385,
        "y": 1845,
        "wires": []
    },
    {
        "id": "45ef34d6.2bf95c",
        "type": "arduino out",
        "z": "61da1d7d.518484",
        "name": "",
        "pin": "12",
        "state": "OUTPUT",
        "arduino": "118e97fc.26aff8",
        "x": 1640,
        "y": 2535,
        "wires": []
    },
    {
        "id": "d7c6a4fa.b0dfa8",
        "type": "ui_chart",
        "z": "61da1d7d.518484",
        "name": "",
        "group": "8f255546.c27868",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "1000",
        "removeOlder": "10",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 1,
        "x": 725,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "d279d4d2.8742b8",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "msg.topic=\"Moisture\";\nmsg.label=\"Moisture\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 455,
        "y": 225,
        "wires": [
            [
                "d7c6a4fa.b0dfa8"
            ]
        ]
    },
    {
        "id": "3ccfa164.a7baae",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "msg.topic=\"Watering\";\nvar water=flow.get(\"water\");\nmsg.payload=msg.payload*500;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 620,
        "y": 375,
        "wires": [
            [
                "d7c6a4fa.b0dfa8"
            ]
        ]
    },
    {
        "id": "1cd557ec.4625c8",
        "type": "schedex",
        "z": "61da1d7d.518484",
        "name": "",
        "suspended": false,
        "lat": "",
        "lon": "",
        "ontime": "09:00",
        "ontopic": "on",
        "onpayload": "on",
        "onoffset": "0",
        "onrandomoffset": 0,
        "offtime": "18:00",
        "offtopic": "off",
        "offpayload": "off",
        "offoffset": 0,
        "offrandomoffset": 0,
        "mon": true,
        "tue": true,
        "wed": true,
        "thu": true,
        "fri": true,
        "sat": true,
        "sun": true,
        "x": 1135,
        "y": 2535,
        "wires": [
            [
                "888ab4a8.5a6638"
            ]
        ]
    },
    {
        "id": "888ab4a8.5a6638",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "if(msg.payload===\"on\")\n{\n    msg.payload=1;\n    flow.set(\"lamp\",1);\n}\nelse \n{\n    msg.payload=0;\n    flow.set(\"lamp\",0);\n}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1400,
        "y": 2535,
        "wires": [
            [
                "45ef34d6.2bf95c",
                "56f0e2c3.dd1b3c"
            ]
        ]
    },
    {
        "id": "c7bdfe6f.d69c1",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "1",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 1375,
        "y": 2790,
        "wires": [
            [
                "91b5189b.a2de88"
            ]
        ]
    },
    {
        "id": "91b5189b.a2de88",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "msg.payload=flow.get(\"lamp\");\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1550,
        "y": 2790,
        "wires": [
            []
        ]
    },
    {
        "id": "56f0e2c3.dd1b3c",
        "type": "debug",
        "z": "61da1d7d.518484",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1440,
        "y": 2655,
        "wires": []
    },
    {
        "id": "bcbe8fde.027cb",
        "type": "ui_text",
        "z": "61da1d7d.518484",
        "group": "1eeedcbb.46d953",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "text",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 1200,
        "y": 2655,
        "wires": []
    },
    {
        "id": "646b928b.300b4c",
        "type": "function",
        "z": "61da1d7d.518484",
        "name": "",
        "func": "var d = new Date();\nmsg.payload=d.toLocaleTimeString();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1050,
        "y": 2700,
        "wires": [
            [
                "bcbe8fde.027cb"
            ]
        ]
    },
    {
        "id": "ea0b9fe5.7fa4c",
        "type": "inject",
        "z": "61da1d7d.518484",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "1",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 895,
        "y": 2685,
        "wires": [
            [
                "646b928b.300b4c"
            ]
        ]
    },
    {
        "id": "c3adc197.07776",
        "type": "ui_group",
        "z": "",
        "name": "Group 5",
        "tab": "5ebe8898.522c38",
        "order": 3,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "ce607c77.3a086",
        "type": "ui_group",
        "z": "",
        "name": "Add new configuration",
        "tab": "d512fc44.fed77",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ec9c9342.c86e2",
        "type": "ui_group",
        "z": "",
        "name": "Current configuration",
        "tab": "f576c5a6.13db78",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "35557d8f.194112",
        "type": "ui_group",
        "z": "",
        "name": "Options",
        "tab": "f576c5a6.13db78",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "4faf0170.b836a",
        "type": "json-db-collection",
        "z": "",
        "name": "PlantConfig",
        "collection": "PlantConfig",
        "save": true
    },
    {
        "id": "af408a37.e5f5c8",
        "type": "ui_group",
        "z": "",
        "name": "Default",
        "tab": "5ebe8898.522c38",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "118e97fc.26aff8",
        "type": "arduino-board",
        "z": "",
        "device": "/dev/ttyUSB0"
    },
    {
        "id": "1eeedcbb.46d953",
        "type": "ui_group",
        "z": "",
        "name": "Change current configuration",
        "tab": "d875d7fe.275278",
        "order": 1,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "f6eb4df1.0d706",
        "type": "ui_group",
        "z": "",
        "name": "Group 1",
        "tab": "c11fa87d.4cbc98",
        "order": 1,
        "disp": false,
        "width": "6",
        "collapse": false
    },
    {
        "id": "8f255546.c27868",
        "type": "ui_group",
        "z": "",
        "name": "Group 4",
        "tab": "5ebe8898.522c38",
        "order": 2,
        "disp": true,
        "width": "12",
        "collapse": false
    },
    {
        "id": "5ebe8898.522c38",
        "type": "ui_tab",
        "z": "",
        "name": "Home",
        "icon": "fa-home",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d512fc44.fed77",
        "type": "ui_tab",
        "z": "",
        "name": "Add new configuration",
        "icon": "fa-plus",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f576c5a6.13db78",
        "type": "ui_tab",
        "z": "",
        "name": "Current configuration",
        "icon": "fa-hand-o-right",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d875d7fe.275278",
        "type": "ui_tab",
        "z": "",
        "name": "Change current configuration",
        "icon": "fa-pencil",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "c11fa87d.4cbc98",
        "type": "ui_tab",
        "z": "",
        "name": "Remove program",
        "icon": "fa-times",
        "order": 5,
        "disabled": false,
        "hidden": false
    }
]